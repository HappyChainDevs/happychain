import{w as Pe,r as v,j as e,x as Oe,u as oe,b as He,c as Ve,y as Ue,L as qe,A as Ie}from"./components-BLd368Cb.js";import{I as Le,u as me,a as Re,b as $e,c as A,d as We,e as Ge,f as _e,g as Ye,h as Xe,i as Ze,j as Je,k as Ke,l as Qe,m as es,n as ss,o as ts,S as ns,L as rs,D as te,p as ue,q as Me,r as Ae,s as as,t as is,v as je,C as os,A as ls,w as cs,x as ds}from"./InfoPopover-PaSJtHpa.js";import{u as ge,a as ms,D as Ne,S as us,C as he,E as hs,L as fe,V as xs,T as ps}from"./Toast-Eg8_vlqZ.js";import{c as C,f as re,d as gs,e as xe,b as se,p as fs,P as ne,a as bs,g as js}from"./number-D-wl6pPl.js";import{c as k}from"./utils-BpA9bqt-.js";import{B as J,T as we}from"./Button-C8z9n4iz.js";import{u as Ns,I as ws}from"./Input-BOHZjH54.js";import{G as be}from"./consts-DRy7E-CO.js";import{c as vs,d as ys,e as Ts,m as Ss,s as ce,f as ae,u as Es}from"./pools-DkhcCFeG.js";import{a as ve,g as Fs,b as Cs}from"./seo-CliX0uaq.js";import{c as le}from"./createLucideIcon-BFoDtFI7.js";import{m as de}from"./proxy-DLbAMy7k.js";import{f as ks}from"./formatUnits-CQZyr6Jb.js";import{S as Is}from"./search-Bda9Knbm.js";import"./arbitrumSepolia-BhgihaGe.js";import"./defineChain-B0Tnjtyc.js";import"./useConfig-DF3L7iUI.js";import"./custom-BqWD8wPQ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=le("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=le("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=le("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=le("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);function pe(s,t,n){var a,l,i,p,d;t==null&&(t=100);function r(){var g=Date.now()-p;g<t&&g>=0?a=setTimeout(r,t-g):(a=null,n||(d=s.apply(i,l),i=l=null))}var h=function(){i=this,l=arguments,p=Date.now();var g=n&&!a;return a||(a=setTimeout(r,t)),g&&(d=s.apply(i,l),i=l=null),d};return h.clear=function(){a&&(clearTimeout(a),a=null)},h.flush=function(){a&&(d=s.apply(i,l),i=l=null,clearTimeout(a),a=null)},h}pe.debounce=pe;var Rs=pe;const Se=Pe(Rs);function Ms(s){let{debounce:t,scroll:n,polyfill:a,offsetSize:l}={debounce:0,scroll:!1,offsetSize:!1};const i=a||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[p,d]=v.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),r=v.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:p}),h=t?typeof t=="number"?t:t.scroll:null,g=t?typeof t=="number"?t:t.resize:null,j=v.useRef(!1);v.useEffect(()=>(j.current=!0,()=>void(j.current=!1)));const[w,o,f]=v.useMemo(()=>{const b=()=>{if(!r.current.element)return;const{left:T,top:E,width:B,height:m,bottom:L,right:u,x,y:P}=r.current.element.getBoundingClientRect(),F={left:T,top:E,width:B,height:m,bottom:L,right:u,x,y:P};r.current.element instanceof HTMLElement&&l&&(F.height=r.current.element.offsetHeight,F.width=r.current.element.offsetWidth),Object.freeze(F),j.current&&!zs(r.current.lastBounds,F)&&d(r.current.lastBounds=F)};return[b,g?Se(b,g):b,h?Se(b,h):b]},[d,l,h,g]);function S(){r.current.scrollContainers&&(r.current.scrollContainers.forEach(b=>b.removeEventListener("scroll",f,!0)),r.current.scrollContainers=null),r.current.resizeObserver&&(r.current.resizeObserver.disconnect(),r.current.resizeObserver=null)}function N(){r.current.element&&(r.current.resizeObserver=new i(f),r.current.resizeObserver.observe(r.current.element),n&&r.current.scrollContainers&&r.current.scrollContainers.forEach(b=>b.addEventListener("scroll",f,{capture:!0,passive:!0})))}const y=b=>{!b||b===r.current.element||(S(),r.current.element=b,r.current.scrollContainers=De(b),N())};return Bs(f,!!n),As(o),v.useEffect(()=>{S(),N()},[n,f,o]),v.useEffect(()=>S,[]),[y,p,w]}function As(s){v.useEffect(()=>{const t=s;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[s])}function Bs(s,t){v.useEffect(()=>{if(t){const n=s;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[s,t])}function De(s){const t=[];if(!s||s===document.body)return t;const{overflow:n,overflowX:a,overflowY:l}=window.getComputedStyle(s);return[n,a,l].some(i=>i==="auto"||i==="scroll")&&t.push(s),[...t,...De(s.parentElement)]}const Ds=["x","y","top","bottom","left","right","width","height"],zs=(s,t)=>Ds.every(n=>s[n]===t[n]),Ee=({swapRoute:{tokenIn:s,tokenOut:t,amountIn:n,amountOut:a,priceImpact:l,derivedValue:i,lpFee:p,protocolFee:d,royaltiesFee:r},isExactOut:h,amountInMax:g,amountOutMin:j,className:w})=>{const o=s.isNFT&&!!t?.isNFT;return e.jsxs("div",{className:k("overflow-hidden rounded-lg border border-night-800 text-night-400 text-sm",w),children:[e.jsx("div",{className:"flex items-center justify-between border border-night-1000 border-b p-4",children:e.jsxs("span",{children:[e.jsx("span",{className:"font-medium text-honey-25",children:"1"})," ",t?.symbol," ="," ",e.jsx("span",{className:"font-medium text-honey-25",children:C(i)})," ",s.symbol]})}),n>0&&a>0?e.jsxs("ul",{className:"mt-2.5 space-y-1 p-4 pt-0",children:[e.jsxs("li",{className:"flex items-center justify-between",children:["Price impact",e.jsx("span",{children:re(l*-1)})]}),p>0&&e.jsxs("li",{className:"flex items-center justify-between",children:["Liquidity provider fee",e.jsx("span",{children:re(p,3)})]}),r>0&&e.jsxs("li",{className:"flex items-center justify-between",children:["Royalties fee",e.jsx("span",{children:re(r,3)})]}),d>0&&e.jsxs("li",{className:"flex items-center justify-between",children:["Protocol fee",e.jsx("span",{children:re(d,3)})]}),o?e.jsxs("li",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-1",children:["NFT dust sent to pool",e.jsxs(Le,{buttonClassName:"h-3 w-3",children:["NFTs can only be traded in whole amounts so any fractional amounts are sent to the pool to reward liquidity providers. Minimize this amount to get the best trade value by adjusting the ",h?"output":"input"," amount selected."]})]}),e.jsxs("span",{children:[C(h?gs(n)-n:a-xe(a),{decimals:h?s.decimals:t.decimals})," ",h?s.symbol:t.symbol]})]}):h?e.jsxs("li",{className:"flex items-center justify-between",children:["Maximum spent",e.jsxs("span",{children:[C(g,{decimals:s.decimals})," ",s.symbol]})]}):e.jsxs("li",{className:"flex items-center justify-between",children:["Minimum received",e.jsxs("span",{children:[C(j,{decimals:t?.decimals})," ",t?.symbol]})]})]}):null]})},Ps=({token:s,address:t})=>{const{load:n,state:a,data:l}=Oe(),{data:i=0n,isLoading:p}=me({id:s.id,address:t,isETH:s.isETH,enabled:!!t&&!s.isNFT});return v.useEffect(()=>{if(!s.isNFT||!t)return;const d=new URLSearchParams({address:t});n(`/resources/vaults/${s.id}/balance?${d.toString()}`)},[s.isNFT,s.id,t,n]),{data:s.isNFT?l?.ok?l.balance:0:i,isLoading:p||a==="loading"}},Os=({version:s,tokenIn:t,tokenOut:n,amountIn:a,amountOut:l,nftsIn:i,nftsOut:p,isExactOut:d,path:r,enabled:h=!0,onSuccess:g})=>{const{address:j,addressArg:w}=ge(),o=Re(s),f=ms(),S=h&&!!j&&!!n,N=d?vs(a,f?.slippage||Ne):a,y=d?l:ys(l,f?.slippage||Ne),b=i.map(({collectionAddr:M})=>M),T=i.map(({tokenId:M})=>BigInt(M)),E=i.map(({quantity:M})=>BigInt(M)),B=p.map(({collectionAddr:M})=>M),m=p.map(({tokenId:M})=>BigInt(M)),L=p.map(({quantity:M})=>BigInt(M)),u=BigInt(Math.floor(Date.now()/1e3)+(f?.deadline||30)*60),x=$e(),P=A({hash:x.data}),F=We(),K=A({hash:F.data}),D=Ge(),O=A({hash:D.data}),R=_e(),H=A({hash:R.data}),W=Ye(),G=A({hash:W.data}),_=Xe(),Y=A({hash:_.data}),V=Ze(),U=A({hash:V.data}),q=Je(),Q=A({hash:q.data}),X=Ke(),ee=A({hash:X.data}),z=Qe(),$=A({hash:z.data}),c=es(),I=A({hash:c.data}),Z=P.isSuccess||K.isSuccess||O.isSuccess||H.isSuccess||G.isSuccess||Y.isSuccess||U.isSuccess||Q.isSuccess||ee.isSuccess||$.isSuccess||I.isSuccess;return ss({title:`Swap ${C(se(a))} ${t.symbol} for ${C(se(l))} ${n?.symbol}`,isLoading:x.isPending||P.isLoading||F.isPending||K.isLoading||D.isPending||O.isLoading||R.isPending||H.isLoading||W.isPending||G.isLoading||_.isPending||Y.isLoading||V.isPending||U.isLoading||q.isPending||Q.isLoading||X.isPending||ee.isLoading||z.isPending||$.isLoading||c.isPending||I.isLoading,isSuccess:Z,isError:x.isError||P.isError||F.isError||K.isError||D.isError||O.isError||R.isError||H.isError||W.isError||G.isError||_.isError||Y.isError||V.isError||U.isError||q.isError||Q.isError||X.isError||ee.isError||z.isError||$.isError||c.isError||I.isError,errorDescription:(x.error||P.error||F.error||K.error||D.error||O.error||R.error||H.error||W.error||G.error||_.error||Y.error||V.error||U.error||q.error||Q.error||X.error||ee.error||z.error||$.error||c.error||I.error)?.message}),v.useEffect(()=>{Z&&g?.()},[Z,g]),{amountInMax:N,amountOutMin:y,swap:()=>{if(S)return t.isNFT&&n.isNFT?c.writeContractAsync({address:o,args:[b,T,E,B,m,L,r,w,u]}):t.isNFT?n.isETH?z.writeContractAsync({address:o,args:[b,T,E,y,r,w,u]}):q.writeContractAsync({address:o,args:[b,T,E,y,r,w,u]}):n.isNFT?t.isETH?X.writeContractAsync({address:o,args:[B,m,L,r,w,u],value:N}):V.writeContractAsync({address:o,args:[B,m,L,N,r,w,u]}):t.isETH?d?W.writeContractAsync({address:o,args:[l,r,w,u],value:N}):_.writeContractAsync({address:o,args:[y,r,w,u],value:a}):n.isETH?d?R.writeContractAsync({address:o,args:[l,N,r,w,u]}):D.writeContractAsync({address:o,args:[a,y,r,w,u]}):d?F.writeContractAsync({address:o,args:[l,N,r,w,u]}):x.writeContractAsync({address:o,args:[a,y,r,w,u]})}}},ze=({tokenIn:s,tokenOut:t,pools:n,amount:a,isExactOut:l})=>{const i=fs(a,l?t?.decimals??18:s.decimals),p=i<=0,{amountInBI:d=0n,amountOutBI:r=0n,legs:h=[],priceImpact:g=0}=Ts(s,t,n,p?1n:i,l)??{},j=h.map(({poolAddress:o,tokenFrom:f,tokenTo:S})=>{const N=n.find(y=>y.id===o);if(N)return{...N,tokenFrom:N.token0.id===f.address?N.token0:N.token1,tokenTo:N.token0.id===S.address?N.token0:N.token1}}).filter(o=>!!o),w=j.length>0&&new Set(j.map(({version:o})=>o)).size===1;return{isValid:w,version:w?j[0]?.version:void 0,amountIn:p?0n:d,amountOut:p?0n:r,tokenIn:j[0]?.tokenFrom??s,tokenOut:j[j.length-1]?.tokenTo??t??void 0,path:j.flatMap(({tokenFrom:o,tokenTo:f},S)=>S===j.length-1?[o.id,f.id]:o.id),priceImpact:g,derivedValue:Ss(j.map(({tokenFrom:o,tokenTo:f})=>se(BigInt(o.reserve),o.decimals)/se(BigInt(f.reserve),f.decimals))),lpFee:ce(j.map(({lpFee:o})=>Number(o))),protocolFee:ce(j.map(({protocolFee:o})=>Number(o))),royaltiesFee:ce(j.map(({royaltiesFee:o})=>Number(o)))}},Hs=(s,t)=>be[s]?.tokens[t]?.map(n=>n.toLowerCase())??[],Vs=(s,t)=>Hs(s,t).reduce((n,a)=>(n[a.toLowerCase()]=!0,n),{}),Us=(s,t)=>be[s]?.collections[t]?.map(n=>n.toLowerCase())??[],qs=(s,t)=>Us(s,t).reduce((n,a)=>(n[a]=!0,n),{}),dt=({matches:s,data:t,location:n})=>{const a=s.find(i=>i.id==="root")?.data.requestInfo,l=ve(a?.origin,n.pathname);return Fs({url:l,title:Cs(t?.tokenOut?`Swap ${t?.tokenIn.symbol} to ${t?.tokenOut.symbol}`:"Swap"),image:t?.tokenOut?`${l}/${t?.tokenIn.id}/${t?.tokenOut.id}.png`:ve(a?.origin,"/img/seo-banner.png")})},ie={amount:"0",nftsIn:[],nftsOut:[],isExactOut:!1};function mt(){const s=oe(),t=He(),{address:n,isConnected:a}=ge(),[l,i]=Ve(),[{amount:p,isExactOut:d,nftsIn:r,nftsOut:h},g]=v.useState(ie),[j,w]=v.useState(!1),[o,f]=v.useState(!1),S=Ue(),N=(c,I)=>{l.set(c,I.id),i(l,{state:"true"})},y=ze({...s,amount:p,isExactOut:d}),b=ae(r),T=ae(h),{isValid:E,version:B="V2",amountIn:m,amountOut:L,tokenIn:u,tokenOut:x,path:P,priceImpact:F}=y,K=Re(B),D=Math.ceil(se(m,u.decimals)),O=Math.floor(se(L,x?.decimals)),R=m>0&&L>0&&(!u.isNFT||D===b)&&(!x?.isNFT||O===T),H=R&&F>=.15,{data:W,refetch:G}=me({id:u.id,address:n,isETH:u.isETH,enabled:!u.isNFT}),{data:_,refetch:Y}=me({id:x?.id,address:n,isETH:x?.isETH,enabled:!x?.isNFT}),V=v.useCallback(()=>{t.state,G(),Y()},[t,G,Y]);Es(V,5e3);const{amountInMax:U,amountOutMin:q,swap:Q}=Os({version:B,tokenIn:u,tokenOut:x,amountIn:m,amountOut:L,isExactOut:d,nftsIn:r,nftsOut:h,path:P,enabled:a&&!!x&&R&&E,onSuccess:()=>{g(ie),V(),w(!1),f(!1)}}),{isApproved:X,approve:ee}=ts({operator:K,token:u,amount:U,enabled:a&&R});v.useEffect(()=>{u.isNFT?g(ie):g(c=>({...c,nftsOut:[]}))},[u.id]),v.useEffect(()=>{x?.isNFT?g(ie):g(c=>({...c,nftsOut:[]}))},[x?.id]);const z=C(m,{decimals:u.decimals}),$=C(L,{decimals:x?.decimals});return e.jsxs("main",{className:"mx-auto max-w-xl px-4 pt-12 pb-20 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 text-night-600",children:[e.jsxs("div",{className:"flex items-center gap-1.5 font-bold text-xl",children:[e.jsx(us,{className:"h-6 w-6"}),e.jsx("h1",{className:"text-night-100",children:"Swap"})]}),e.jsx(ns,{})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx(Fe,{token:u,otherToken:x,isOut:!1,balance:W,amount:d?u.isNFT?D.toString():z:p,selectedNfts:r,requiredNftSelectionAmount:d&&T>0?D:void 0,onSelect:c=>N("in",c),onUpdateAmount:c=>g({amount:c,nftsIn:[],nftsOut:[],isExactOut:!1}),onSelectNfts:c=>{const I=ae(c);g(Z=>b===0&&T===0||b>0&&b!==I?{amount:I.toString(),nftsIn:c,nftsOut:[],isExactOut:!1}:{...Z,nftsIn:c})}},`${S.search}-in`),e.jsx(qe,{to:`/swap?in=${x?.id}&out=${u.id}`,"aria-disabled":x?.id?"false":"true",onClick:c=>!x?.id&&c.preventDefault(),className:k("-my-2 relative z-10 mx-auto flex h-8 w-8 items-center justify-center rounded border-4 border-night-1200 bg-night-1100 text-honey-25",x?.id?"group":"cursor-not-allowed text-night-800"),children:e.jsx(ye,{className:"h-3.5 w-3.5 transition-transform group-hover:rotate-180"})}),e.jsx(Fe,{token:x,otherToken:u,isOut:!0,balance:_,amount:d?p:x?.isNFT?O.toString():$,selectedNfts:h,requiredNftSelectionAmount:!d&&b>0?O:void 0,onSelect:c=>N("out",c),onUpdateAmount:c=>g({amount:c,nftsIn:[],nftsOut:[],isExactOut:!0}),onSelectNfts:c=>{const I=ae(c);g(Z=>b===0&&T===0||T>0&&T!==I?{amount:I.toString(),nftsIn:[],nftsOut:c,isExactOut:!0}:{...Z,nftsOut:c})}},`${S.search}-out`),e.jsx("div",{className:"mt-4 space-y-4",children:e.jsx(he,{children:()=>e.jsxs(e.Fragment,{children:[H?e.jsx(rs,{className:"rounded-lg border border-red-500 bg-red-500/20 p-3 text-honey-25/90",onCheckedChange:c=>f(!!c),checked:o,id:"priceImpactOptIn",description:"You will lose a big portion of your funds in this trade. Please tick the box if you would like to continue.",checkboxClassName:"border-red-900",children:"Price impact is too high"}):null,x&&!E?e.jsx(J,{className:"w-full",size:"lg",disabled:!0,children:"Swap route not available"}):!X&&R&&(!H||o)?e.jsxs(we,{className:"w-full",size:"lg",onClick:()=>ee(),children:["Approve ",u.name]}):e.jsxs(te,{open:j,onOpenChange:w,children:[e.jsx(ue,{asChild:!0,children:e.jsx(we,{className:"w-full",size:"lg",disabled:!R||H&&!o,children:"Swap Items"})}),e.jsxs(Me,{children:[e.jsxs(Ae,{children:["Swap ",z," ",u.symbol," for"," ",$," ",x?.symbol]}),e.jsxs("div",{children:[e.jsxs("div",{className:"overflow-hidden rounded-lg bg-night-1100",children:[e.jsxs("div",{className:"flex items-center bg-night-900 px-3.5 py-2.5",children:[e.jsx(ne,{token:u,className:"h-6 w-6"}),e.jsx("span",{className:"ml-2 font-medium text-honey-25",children:u.name})]}),e.jsx("div",{className:"p-4",children:u.isNFT?r.length>0?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:k("flex",{"-space-x-5":u.type==="ERC721"}),children:r.slice(0,Math.min(r.length,5)).map(c=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{className:"h-12 w-12 rounded border-2 border-night-1100",src:c.image.uri,alt:c.metadata.name}),u.type==="ERC1155"?e.jsxs("p",{className:"text-night-600 text-xs",children:[c.quantity,"x"]}):null]},c.tokenId))}),r.length>5?e.jsx("div",{className:"flex items-center rounded-md bg-night-900 px-2 py-1.5",children:e.jsxs("p",{className:"font-semibold text-night-500 text-xs",children:["+",r.length-5]})}):null]}):null:e.jsx("p",{children:z})})]}),e.jsx("div",{className:"-my-2 relative z-10 mx-auto flex h-8 w-8 items-center justify-center rounded border-4 border-night-1200 bg-night-1100 text-honey-25",children:e.jsx(ye,{className:"h-3.5 w-3.5"})}),e.jsxs("div",{className:"overflow-hidden rounded-lg bg-night-1100",children:[e.jsxs("div",{className:"flex items-center bg-night-900 px-3.5 py-2.5",children:[e.jsx(ne,{token:x,className:"h-6 w-6"}),e.jsx("span",{className:"ml-2 font-medium text-honey-25",children:x?.name})]}),e.jsx("div",{className:"p-4",children:x?.isNFT?h.length>0?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:k("flex",{"-space-x-5":x?.type==="ERC721"}),children:h.slice(0,Math.min(h.length,5)).map(c=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{className:"h-12 w-12 rounded border-2 border-night-1100",src:c.image.uri,alt:c.metadata.name}),x?.type==="ERC1155"?e.jsxs("p",{className:"text-night-600 text-xs",children:[c.quantity,"x"]}):null]},c.tokenId))}),h.length>5?e.jsx("div",{className:"flex items-center rounded-md bg-night-900 px-2 py-1.5",children:e.jsxs("p",{className:"font-semibold text-night-500 text-xs",children:["+",h.length-5]})}):null]}):null:e.jsx("p",{children:$})})]}),e.jsx(Ee,{className:"mt-4",swapRoute:y,isExactOut:d,amountInMax:u.isNFT?xe(m):U,amountOutMin:x?.isNFT?xe(L):q}),e.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-3",children:[e.jsx(J,{size:"lg",className:"col-span-full sm:col-span-2",onClick:()=>Q(),children:"Confirm Swap"}),e.jsx(as,{asChild:!0,children:e.jsx(J,{size:"lg",variant:"secondary",className:"col-span-full sm:col-span-1",children:"Cancel"})})]})]})]})]})]})})}),x&&E?e.jsx(Ee,{className:"mt-4",swapRoute:y,isExactOut:d,amountInMax:U,amountOutMin:q}):null]})]})}const Fe=({token:s,otherToken:t,isOut:n,balance:a=0n,amount:l,selectedNfts:i,requiredNftSelectionAmount:p,onSelect:d,onUpdateAmount:r,onSelectNfts:h,className:g})=>{const j=Number(l),w=(s?.priceUSD??0)*(Number.isNaN(j)||j===0?1:j),{tokenInNFTBalance:o}=oe(),[f,S]=v.useState(!0),[N,y]=Ms(),{createTokenUrl:b}=is(),[T,E]=v.useState(!1),B=l==="0"?"Select items":`Select ${l} ${Number(l)===1?"item":"items"}`;return s?e.jsxs("div",{className:k("overflow-hidden rounded-lg bg-night-1100",g),children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 p-4",children:[e.jsxs(te,{children:[e.jsx(ke,{disabledTokenIds:[s.id,t?.id].filter(m=>!!m),isOut:n,onSelect:d}),e.jsx(ue,{asChild:!0,children:e.jsxs("button",{type:"button",className:"flex items-center gap-4 text-left",children:[e.jsx(ne,{className:"h-12 w-12",token:s}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("span",{className:"flex items-center gap-1.5 font-medium text-honey-25 text-sm sm:text-lg",children:[s.symbol," ",e.jsx(Te,{className:"h-3 w-3"})]}),s.isNFT?e.jsx(e.Fragment,{children:s.name.toUpperCase()!==s.collections[0]?.name.toUpperCase()&&e.jsx("p",{className:"text-night-400 text-xs sm:text-sm",children:s.collections[0]?.name})}):e.jsx(e.Fragment,{children:s.name.toUpperCase()!==s.symbol.toUpperCase()?e.jsx("span",{className:"block text-night-400 text-xs sm:text-sm",children:s.name}):null})]})]})})]}),e.jsx("div",{className:"space-y-1 text-right",children:s.isNFT?i.length>0?e.jsxs("div",{className:"flex items-center space-x-2",children:[i.length>5?e.jsx("div",{className:"flex items-center rounded-md bg-night-900 px-2 py-1.5",children:e.jsxs("p",{className:"font-semibold text-night-500 text-xs",children:["+",i.length-5]})}):null,e.jsx("div",{className:k("flex",{"-space-x-5":s.type==="ERC721"}),children:i.slice(0,Math.min(i.length,5)).map(m=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{className:"h-12 w-12 rounded border-2 border-night-1100",src:m.image.uri,alt:m.metadata.name}),s.type==="ERC1155"?e.jsxs("p",{className:"text-night-600 text-xs",children:[m.quantity,"x"]}):null]},m.tokenId))}),e.jsxs(J,{variant:"ghost",onClick:()=>S(m=>!m),children:[e.jsx(Te,{className:k("h-4 w-auto transition-transform will-change-transform",!f&&"-rotate-180")}),e.jsx("span",{className:"sr-only",children:f?"See selected NFTs":"Close"})]})]}):e.jsx(he,{children:()=>e.jsxs(e.Fragment,{children:[e.jsx(te,{open:T,onOpenChange:E,children:T?e.jsx(je,{type:n?"vault":"inventory",token:s,selectedTokens:i,requiredAmount:p,onSubmit:h,children:({amount:m})=>p?void 0:e.jsx(Ce,{amount:m,isExactOut:n})}):null}),e.jsx(J,{variant:"dark",size:"md",onClick:()=>E(!0),children:B})]})}):e.jsx(he,{children:()=>e.jsxs(e.Fragment,{children:[e.jsx(os,{value:l,onChange:r,disabled:!!t?.isNFT}),w>0?e.jsx("span",{className:"block text-night-400 text-sm",children:bs(w)}):null]})})})]}),e.jsx(de.div,{animate:{height:y.height},children:e.jsx("div",{ref:N,children:e.jsx(ls,{initial:!1,mode:"popLayout",children:f?null:e.jsx(de.div,{exit:{opacity:0},children:e.jsx(de.div,{className:"grid max-h-64 grid-cols-4 gap-3 overflow-auto p-4",initial:{opacity:0},animate:{opacity:1,transition:{delay:.2}},exit:{opacity:0},transition:{duration:.15},children:i.map(m=>e.jsxs("div",{className:"flex flex-col overflow-hidden rounded-lg bg-night-900",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:m.image.uri,alt:m.tokenId,className:"w-full"}),s.type==="ERC1155"?e.jsxs("span",{className:"absolute right-1.5 bottom-1.5 rounded-lg bg-night-700/80 px-2 py-0.5 font-bold text-night-100 text-xs",children:[m.quantity,"x"]}):null]}),e.jsxs("div",{className:"flex items-start justify-between gap-2 p-2.5",children:[e.jsxs("div",{className:"min-w-0 text-left",children:[e.jsx("p",{className:"truncate font-medium text-honey-25 text-xs",children:m.metadata.name}),e.jsxs("p",{className:"truncate text-[0.6rem] text-night-400",children:["#",m.tokenId]})]}),e.jsxs("a",{target:"_blank",rel:"noopener noreferrer",title:`View ${m.metadata.name} in the marketplace`,className:"text-night-400 transition-colors hover:text-night-100",href:b(m.collectionUrlSlug,m.tokenId),children:[e.jsx(hs,{className:"h-3.5 w-auto","aria-hidden":"true"}),e.jsxs("span",{className:"sr-only",children:["View ",m.metadata.name," in the marketplace"]})]})]})]},m.tokenId))})},"collapsed")})})}),e.jsx("div",{className:"bg-night-1000 px-4 py-2.5 text-sm",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("span",{className:"text-night-400 sm:text-sm",children:[s.isNFT&&n?"Vault":s.isNFT?"Inventory":"Balance",":"]}),s.isNFT?e.jsx(e.Fragment,{children:n?C(BigInt(s.reserve),{decimals:s.decimals}):e.jsx(v.Suspense,{fallback:e.jsx(fe,{className:"inline-block h-3.5 w-3.5"}),children:e.jsx(Ie,{resolve:o,children:m=>js(m??0)})})}):e.jsx(xs,{children:e.jsx("span",{className:"font-semibold text-honey-25 sm:text-sm",children:C(a,{decimals:s.decimals})})})]}),!s?.isNFT&&t?.isNFT?e.jsx(Le,{children:"Input is disabled because the amount will be auto-calculated based on the selected NFTs."}):null,!s?.isNFT&&!t?.isNFT&&!n?e.jsx(J,{size:"xs",variant:"secondary",onClick:()=>r(ks(a,s.decimals)),children:"Max"}):null,i.length>0?e.jsxs(e.Fragment,{children:[e.jsx(te,{open:T,onOpenChange:E,children:T?e.jsx(je,{type:n?"vault":"inventory",token:s,selectedTokens:i,requiredAmount:p,onSubmit:h,children:({amount:m})=>p?void 0:e.jsx(Ce,{amount:m,isExactOut:n})}):null}),e.jsx(J,{variant:"ghost",onClick:()=>E(!0),children:"Edit Selection"})]}):null]})})]}):e.jsxs(te,{children:[e.jsx(ke,{disabledTokenIds:[t?.id].filter(m=>!!m),isOut:n,onSelect:d}),e.jsx(ue,{asChild:!0,children:e.jsxs("button",{type:"button",className:k("group flex w-full items-center gap-4 rounded-lg bg-night-1100 px-4 py-5 font-medium text-night-400 text-xl transition-colors hover:text-honey-25",g),children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-night-800 text-night-600 transition-colors group-hover:text-honey-50",children:e.jsx(Be,{className:"h-6 w-6"})}),"Select Asset"]})})]})},Ce=({amount:s,isExactOut:t})=>{const n=oe(),{amountIn:a,amountOut:l,tokenIn:i,tokenOut:p}=ze({...n,amount:s,isExactOut:t});return!p||a===0n&&l===0n?null:e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-night-800 p-4",children:[e.jsx("span",{className:"text-night-400 text-sm",children:"Cost:"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ne,{token:t?i:p,className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate font-medium text-honey-25 text-sm",children:t?C(a,{decimals:i.decimals}):C(l,{decimals:p?.decimals})})]})]})},ke=({disabledTokenIds:s=[],isOut:t,onSelect:n})=>{const[a,l]=v.useState("all"),[i,p]=v.useState(""),[d,r]=v.useState(""),h=Ns(),{tokens:g}=oe(),j=d?Vs(d,h):{},w=d?qs(d,h):{};return e.jsxs(Me,{children:[e.jsxs(Ae,{children:[e.jsxs(cs,{children:["Select an asset to ",t?"buy":"sell"]}),e.jsx(ds,{children:"Choose from the list of tokens and NFTs below."})]}),e.jsxs("div",{className:"space-y-4 rounded-lg bg-night-1100 p-3 sm:p-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:[e.jsxs("button",{type:"button",className:k("flex items-center gap-1.5 rounded-lg border border-border bg-transparent px-2 py-2 font-medium text-night-500 text-sm transition-colors hover:text-honey-25 sm:gap-2.5 sm:px-3",a==="all"&&"border-night-800 bg-night-800 text-honey-25"),onClick:()=>l("all"),children:[e.jsx(Ls,{className:"h-4 w-4 shrink-0"}),"All"]}),e.jsxs("button",{type:"button",className:k("flex items-center gap-1.5 rounded-lg border border-border bg-transparent px-2 py-2 font-medium text-night-500 text-sm transition-colors hover:text-honey-25 sm:gap-2.5 sm:px-3",a==="tokens"&&"border-night-800 bg-night-800 text-honey-25"),onClick:()=>l("tokens"),children:[e.jsx(ps,{className:"h-4 w-4 shrink-0"}),"Tokens"]}),e.jsxs("button",{type:"button",className:k("flex items-center gap-1.5 rounded-lg border border-border bg-transparent px-2 py-2 font-medium text-night-500 text-sm transition-colors hover:text-honey-25 sm:gap-2.5 sm:px-3",a==="collections"&&"border-night-800 bg-night-800 text-honey-25"),onClick:()=>l("collections"),children:[e.jsx(Be,{className:"h-4 w-4 shrink-0"}),"Collections"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"flex items-center rounded-md border border-night-800 pl-2",children:[e.jsx(Is,{className:"h-5 w-5 text-night-400"}),e.jsx(ws,{type:"search",placeholder:"Search",className:"h-auto w-auto max-w-[128px] border-none px-2 py-1.5 ring-offset-transparent focus-visible:ring-0 focus-visible:ring-transparent",value:i,onChange:o=>p(o.target.value)})]}),Object.entries(be).map(([o,{name:f,image:S,tokens:N,collections:y}])=>h in N||h in y?e.jsxs("button",{type:"button",className:k("flex items-center gap-1 rounded-full border border-night-800 px-2.5 py-1.5 text-xs transition-colors hover:bg-night-800 active:bg-night-900",d===o&&"bg-night-900"),onClick:()=>r(d===o?"":o),children:[e.jsx("img",{src:S,alt:"",className:"h-4 w-4 rounded"}),f]},o):null)]})]}),e.jsx(v.Suspense,{fallback:e.jsx("div",{className:"flex h-80 items-center justify-center",children:e.jsx(fe,{className:"h-6 w-6"})}),children:e.jsx(Ie,{resolve:g,children:o=>e.jsx("ul",{className:"h-80 overflow-auto border-night-900 border-t pt-4",children:o.filter(({id:f,symbol:S,name:N,collections:y,isNFT:b})=>(!i||S.toLowerCase().includes(i.toLowerCase())||N.toLowerCase().includes(i.toLowerCase())||y.some(T=>T.name.toLowerCase().includes(i.toLowerCase())))&&(!d||!!j[f]||y.some(T=>w[T.id.toLowerCase()]))&&(a==="all"||(a==="collections"?b:!b))).map(f=>e.jsx($s,{disabled:s.includes(f.id),onSelect:n,token:f},f.id))})})})]})]})},$s=({token:s,disabled:t,onSelect:n})=>{const{address:a}=ge(),{data:l,isLoading:i}=Ps({token:s,address:a});return e.jsxs("li",{className:k("relative rounded-lg px-3 py-2 hover:bg-night-900",t&&"pointer-events-none opacity-50"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ne,{token:s,className:"h-9 w-9"}),e.jsxs("div",{className:"text-left text-sm",children:[e.jsx("span",{className:"block font-semibold text-honey-25",children:s.symbol}),s.name.toUpperCase()!==s.symbol.toUpperCase()?e.jsx("span",{className:"block text-night-600",children:s.name}):s.name.toUpperCase()!==s.collections[0]?.name.toUpperCase()?e.jsx("p",{className:"text-night-400 text-xs sm:text-sm",children:s.collections[0]?.name}):null]})]}),i?e.jsx(fe,{className:"h-4 w-4"}):a?e.jsx("p",{className:"text-base-400 text-sm",children:C(l,{decimals:s.decimals})}):null]}),e.jsx("button",{type:"button",className:"absolute inset-0 h-full w-full",onClick:()=>n(s)})]})};export{mt as default,dt as meta};
